#!/usr/bin/python3
import sys, argparse, logging
from pprint import pprint

sys.path.append('src');
from cloudinventario.cloudinventario import CloudInventario

def getArgs():
   parser = argparse.ArgumentParser(description='CloudInventory args')
   #parser.add_argument('-c', '--config', action='store',
   #                    help='Config file')
   parser.add_argument('-n', '--name', action='store',
                       help='Collector name')
   parser.add_argument('-v', '--verbose', action='count', default=0,
                       help='Verbose')
   args = parser.parse_args()
   return args

def main():
  args = getArgs()

  # init logging
  level = logging.WARNING
  if args.verbose > 1:
    level = logging.DEBUG
  elif args.verbose > 0:
    level = logging.INFO
  logging.basicConfig(format='%(asctime)s [%(levelname)s] %(message)s', level=level)

  # TODO: parse config here !
  cinv = CloudInventario("config.yaml")
  res = cinv.collect(args.name)
  cinv.store()

sys.exit(main())
